'use strict';DP.define(function(f){function l(a){a.css("top",(document.documentElement.scrollTop||document.body.scrollTop)+"px")}var g=DP.DOM,k=6==f.UA.ie,m=g("body"),h=g(window),n=0,j=new f.Class({Implements:"attrs events",initialize:function(a){var b=this,c,e,d;b.set({opt:a});a=b.get("opt");f.bind("position",b);c=g.create("div",{"class":a.winCls}).css({"z-index":a.zIndex,width:a.size.x,height:a.size.y});e=g.create("a",{"class":a.closeCls}).text("关闭").attr("href","javascript:;");d=g.create("div",
{"class":a.contCls});(a.url.dialog||a.url).inject(d);a.closable&&e.inject(c).on("click",function(a){a.prevent();b.fire("closeBtnClick")});d.inject(c);b.on("closeBtnClick",function(){b.close()});b.set("closeBtn",e);b.set("needRepose",a.needRepose);b.set("win",c)},position:function(){var a=this.get("needRepose"),b=this.get("win"),c=b.css("height"),e=b.css("width"),d=window.innerWidth||document.documentElement.clientWidth,f=window.innerHeight||document.documentElement.clientHeight;a&&b.css({top:(f-c)/
2+(k?document.documentElement.scrollTop+document.body.scrollTop:0),left:(d-e)/2})},open:function(){var a=this.get("win"),b=this.get("opt");this.fire("open");if(!this.overlay){var c=this.overlay=g.create("div").attr({"class":"mbox_overlay"});c.el(0).style.cssText="visibility:visible;top: 0px; left: 0px; width: 100%; background-color: #000; z-index: 99; zoom: 1; opacity: 0.2;filter: alpha(opacity=20);position: fixed; _position:absolute;";c.inject(m);c.css({"z-index":2150,height:window.innerHeight||
document.documentElement.clientHeight});this.reposeOverlay=function(){l(c)};this.resizeOverlay=function(){c.css("height",window.innerHeight||document.documentElement.clientHeight)};k&&(l(c),h.on("scroll",this.reposeOverlay));h.on("resize",this.resizeOverlay)}b.needRepose&&(this.position(),h.on("resize",this.position));this.exist?a.css("visibility","visible"):(a.inject(m),this.exist=!0);this.fire("show");a.all(".dialog-title");a=b.needRepose;b=k?"absolute":a?"fixed":"absolute";this.get("win").css("position",
b);this.position();if(k&&a)h.on("scroll",this.position);n++;return this},close:function(){var a=this.get("win");this.fire("beforeclose");a.destroy();this.overlay&&this.overlay.destroy();k&&h.off("scroll",this.reposeOverlay);h.off("resize",this.resizeOverlay);h.off("resize",this.position);this.fire("close");n--}});j.dialog=function(a,b,c){var e=g.create("div"),a=a&&g.create("div",{"class":"DialogTitle"}).html(a).inject(e),d=g.create("div",{"class":"DialogContent"});"string"==typeof b?d.html(b):b.inject(d);
d.inject(e);var i=c&&g.create("div",{"class":"DialogButtons"}).inject(e);(c=c&&f.makeArray(c))&&c.forEach(function(a){f.isString(a)?i.html(a):a.inject(i)});return{dialog:e,title:a,content:d,btns:i}};j.btn=function(a,b,c,e){var d="";switch(b){case "white":d="m-btn";break;case "newWhite":d="m-new-ubtn";break;case "newYellow":d="m-new-rbtn";break;default:d="m-rbtn"}b=g.create("a",{href:"javascript:","class":d+(e?" "+e:"")});b.html("<span>"+a+"</span>");b.on("click",function(a){a.prevent()});if(c&&f.isObject(c))for(var i in c)b.on(i,
c[i]);return b};j.siteBtn=function(a,b,c,e){b=g.create("span",{"class":("white"===b?"medi-btn-ash btn":"medi-btn btn")+(e?" "+e:"")});b.html('<a href="javascript" class="btn-txt">'+a+"</a>");b.on("click",function(a){a.prevent()});if(c&&f.isObject(c))for(var d in c)b.on(d,c[d]);return b};j.tpl=function(a){if(f.isObject(a))return f.sub('<div class="mcont Fix"><span class="ib-{icon} icon Left"></span><h3>{title}</h3>{contentTop}</div><div>{contentBottom}</div>',a)};f.Class.setAttrs(j,{opt:{value:{winCls:"mbox-window",
closeCls:"mbox-btn-close",contCls:"mbox-content",closable:!0,zIndex:1000001,size:{x:350,y:"auto"},needRepose:!0},setter:function(a){var b=this.get("opt"),c=b.size,a=f.mix(b,a);a.size=f.mix(c,b.size);return a}},win:{},needRepose:{},closeBtn:{}});return j});
